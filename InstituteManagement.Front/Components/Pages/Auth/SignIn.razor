@page "/signin"
@using System.Text.Json
@using InstituteManagement.Shared.DTOs.Auth
@rendermode InteractiveServer
@inherits SignInBase

<PageTitle>@L["SignInTitle"]</PageTitle>

<div class="row justify-content-center mt-4">
    <div class="col-md-6">
        <div class="card shadow-sm p-4">
            <h4 class="mb-3 text-center">@L["SignInTitle"]</h4>

            <EditForm EditContext="editContext" OnValidSubmit="HandleSignIn">
                <div class="mb-3">
                    <label class="form-label">@L["UsernameOrEmail"]</label>
                    <InputText @bind-Value="model.UsernameOrEmail" class="form-control" />
                    <ValidationMessage For="() => model.UsernameOrEmail" />
                </div>

                <div class="mb-3">
                    <label class="form-label">@L["Password"]</label>
                    <InputText @bind-Value="model.Password" type="password" class="form-control" />
                    <ValidationMessage For="() => model.Password" />
                </div>

                <div class="form-check mb-3">
                    <InputCheckbox @bind-Value="model.RememberMe" class="form-check-input" />
                    <label class="form-check-label">@L["RememberMe"]</label>
                </div>

                <div class="d-grid mb-2">
                    <button type="submit" class="btn btn-primary" disabled="@isSubmitting">
                        @if (isSubmitting)
                        {
                            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>

                            @L["SigningIn"]
                        }
                        else
                        {
                            @L["SignIn"]
                        }
                    </button>
                </div>

                @if (!string.IsNullOrEmpty(responseMessageKey))
                {
                    <div class="alert alert-danger mt-2">@L[responseMessageKey]</div>
                }
                else if (!string.IsNullOrEmpty(rawResponseMessage))
                {
                    <div class="alert alert-danger mt-2">@rawResponseMessage</div>
                }
                @if (recaptchaFailed)
                {
                    <div class="alert alert-danger mt-2">@L["RecaptchaTokenRequired"]</div>
                }

            </EditForm>
        </div>
    </div>
</div>
